<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mi Universo üíñ</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&display=swap" rel="stylesheet">
<style>
body {
    margin: 0;
    overflow: hidden;
    background: black;
    font-family: 'Playfair Display', serif;
}
canvas {
    display: block;
}
#final {
    position: fixed;
    inset: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    opacity: 0;
    pointer-events: none;
    transition: opacity 2s ease;
    z-index: 9999;
}
#final.mostrar { 
    opacity:1; 
    pointer-events: all; 
}
#final img {
    width: 300px; /* un poco m√°s grande */
    height: 300px;
    object-fit: cover;
    border-radius: 20px;
    box-shadow: 0 0 50px rgba(255,105,180,0.8);
    margin-bottom: 20px;
}
#final p {
    max-width: 90%;
    text-align: center;
    font-size: 1.6rem; /* m√°s grande */
    color: #ffb6d9;
    line-height: 1.6;
}
</style>
</head>
<body>
<canvas id="espacio"></canvas>

<div id="final">
    <img src="foto9.jpeg" alt="Foto final">
    <p>Feliz cumplea√±os, amor. Gracias por existir y por hacer mi vida m√°s bonita desde que llegaste. Te amo hoy y siempre.</p>
</div>

<script>
const canvas = document.getElementById("espacio");
const ctx = canvas.getContext("2d");

// Ajuste para alta resoluci√≥n
function ajustarCanvas() {
    const dpr = window.devicePixelRatio || 1;
    canvas.width = window.innerWidth * dpr;
    canvas.height = window.innerHeight * dpr;
    ctx.setTransform(1,0,0,1,0,0);
    ctx.scale(dpr,dpr);
}
ajustarCanvas();

/* ================= ESTRELLAS ================= */
let estrellas = [];
for (let i = 0; i < 500; i++) {
    estrellas.push({
        x: Math.random() * canvas.width/window.devicePixelRatio - window.innerWidth/2,
        y: Math.random() * canvas.height/window.devicePixelRatio - window.innerHeight/2,
        z: Math.random() * 1500 + 300,
        speed: Math.random() * 20 + 15, // m√°s r√°pido
        size: Math.random() * 2 + 1,
        glow: Math.random() * 0.4 + 0.2,
        color: "#ffffb3"
    });
}

/* ================= MENSAJES ================= */
const mensajes = [
    "Te Amo üíñ", "Te Quiero üíï", "Eres Mi Universo üåå",
    "Mi Amor üíò", "Mi Vida ‚ú®", "Siempre T√∫ üíû",
    "Mi Todo üíù", "Amor Eterno üíì", "Mi Estrella ‚≠ê"
];

/* ================= FOTOS ================= */
const fotosNombres = [
    "foto1.jpeg","foto2.jpeg","foto3.jpeg","foto4.jpeg",
    "foto5.jpeg","foto6.jpeg","foto7.jpeg","foto8.jpeg"
];
const fotos = fotosNombres.map(src => {
    const img = new Image();
    img.src = src;
    return img;
});

/* ================= ELEMENTOS ================= */
let elementos = [];
let TOTAL = window.innerWidth < 768 ? 10 : 30; // menos elementos en m√≥viles
let finalizarAnimacion = false;

function crearElemento() {
    return {
        x: Math.random() * canvas.width/window.devicePixelRatio - window.innerWidth/2,
        y: Math.random() * canvas.height/window.devicePixelRatio - window.innerHeight/2,
        z: Math.random() * 1500 + 600,
        speed: Math.random() * 8 + 6, // m√°s r√°pido
        texto: mensajes[Math.floor(Math.random() * mensajes.length)],
        img: fotos[Math.floor(Math.random() * fotos.length)]
    };
}

for (let i = 0; i < TOTAL; i++) {
    elementos.push(crearElemento());
}

/* ================= ANIMACI√ìN ================= */
let tiempo = 0;
function animar() {
    ctx.clearRect(0,0,canvas.width,canvas.height);
    ctx.save();
    ctx.translate(window.innerWidth/2, window.innerHeight/2);

    // Estrellas
    estrellas.forEach(s => {
        s.z -= s.speed;
        if (s.z <= 0) s.z = 1500;
        const k = 500 / s.z;
        const x = s.x * k;
        const y = s.y * k;
        const r = s.size * k;
        const g = ctx.createRadialGradient(x,y,0,x,y,r*4);
        g.addColorStop(0, s.color);
        g.addColorStop(1,"rgba(0,0,0,0)");
        ctx.fillStyle = g;
        ctx.beginPath();
        ctx.arc(x,y,r,0,Math.PI*2);
        ctx.fill();
    });

    // Textos y fotos
    if(!finalizarAnimacion){
        elementos.forEach((e,i) => {
            e.z -= e.speed;
            if (e.z < 50) {
                elementos[i] = crearElemento();
                return;
            }
            const k = 500 / e.z;
            if (k > 1.5) return; // limitar tama√±o m√°ximo
            const x = e.x * k;
            const y = e.y * k;
            const img = e.img;
            const size = 100 * k; // fotos m√°s grandes
            ctx.globalAlpha = k * 1.2;
            ctx.drawImage(img, x - size/2, y - size/2, size, size);
            ctx.fillStyle = "#ff69b4";
            ctx.font = `${28*k}px 'Playfair Display', serif`; // textos m√°s grandes
            ctx.textAlign = "center";
            ctx.fillText(e.texto, x, y - 50*k);
            ctx.globalAlpha = 1;
        });
    }

    ctx.restore();
    tiempo += 1/60;

    if(tiempo >= 7 && !document.getElementById("final").classList.contains("mostrar")) {
        finalizarAnimacion = true;
        mostrarFinal();
    }

    requestAnimationFrame(animar);
}

animar();

window.onresize = () => {
    ajustarCanvas();
};

/* ================= FINAL ================= */
function mostrarFinal(){
    const final = document.getElementById("final");
    final.classList.add("mostrar");

    // Estrellas rosadas extra
    const estrellasFinal = [];
    for(let i=0;i<400;i++){
        estrellasFinal.push({
            x: Math.random()*canvas.width/window.devicePixelRatio - window.innerWidth/2,
            y: Math.random()*canvas.height/window.devicePixelRatio - window.innerHeight/2,
            z: Math.random()*500+300,
            size: Math.random()*2 + 1,
            color:"#ff69b4",
            speed: Math.random()*5 + 2
        });
    }
    estrellas = estrellasFinal;

    function animarFinal() {
        ctx.clearRect(0,0,canvas.width,canvas.height);
        ctx.save();
        ctx.translate(window.innerWidth/2, window.innerHeight/2);
        estrellas.forEach(s => {
            s.z -= s.speed;
            if(s.z<=0) s.z = 500;
            const k = 500 / s.z;
            const x = s.x*k;
            const y = s.y*k;
            const r = s.size*k;
            const grad = ctx.createRadialGradient(x,y,0,x,y,r*4);
            grad.addColorStop(0,s.color);
            grad.addColorStop(1,"rgba(0,0,0,0)");
            ctx.fillStyle = grad;
            ctx.beginPath();
            ctx.arc(x,y,r,0,Math.PI*2);
            ctx.fill();
        });
        ctx.restore();
        requestAnimationFrame(animarFinal);
    }
    animarFinal();
}
</script>
</body>
</html>
