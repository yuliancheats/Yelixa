<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mi Universo ðŸ’–</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&display=swap" rel="stylesheet">
<style>
body {
    margin: 0;
    overflow: hidden;
    background: black;
    font-family: 'Playfair Display', serif;
}
canvas {
    display: block;
}
#final {
    position: fixed;
    inset: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    opacity: 0;
    pointer-events: none;
    transition: opacity 2s ease;
    z-index: 9999;
}
#final.mostrar { 
    opacity:1; 
    pointer-events: all; 
}
#final img {
    width: 280px;
    height: 280px;
    object-fit: cover;
    border-radius: 20px;
    box-shadow: 0 0 50px rgba(255,105,180,0.8);
    margin-bottom: 20px;
}
#final p {
    max-width: 90%;
    text-align: center;
    font-size: 1.4rem;
    color: #ffb6d9;
    line-height: 1.6;
}
</style>
</head>
<body>
<canvas id="espacio"></canvas>

<div id="final">
    <img src="foto9.jpeg" alt="Foto final">
    <p>Feliz cumpleaÃ±os, amor. Gracias por existir y por hacer mi vida mÃ¡s bonita desde que llegaste. Te amo hoy y siempre.</p>
</div>

<script>
const canvas = document.getElementById("espacio");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth;
canvas.height = innerHeight;

/* ================= ESCALADO ================= */
let scaleFactor = Math.min(canvas.width/1920, canvas.height/1080);

/* ================= ESTRELLAS ================= */
let estrellas = [];
for (let i = 0; i < 500; i++) {
    estrellas.push({
        x: Math.random() * canvas.width - canvas.width/2,
        y: Math.random() * canvas.height - canvas.height/2,
        z: Math.random() * 1500 + 300,
        speed: Math.random() * 12 + 6,
        size: Math.random() * 1.5 + 0.5,
        glow: Math.random() * 0.4 + 0.2,
        color: "#ffffb3"
    });
}

/* ================= MENSAJES ================= */
const mensajes = [
    "Te Amo ðŸ’–", "Te Quiero ðŸ’•", "Eres Mi Universo ðŸŒŒ",
    "Mi Amor ðŸ’˜", "Mi Vida âœ¨", "Siempre TÃº ðŸ’ž",
    "Mi Todo ðŸ’", "Amor Eterno ðŸ’“", "Mi Estrella â­"
];

/* ================= FOTOS ================= */
const fotosNombres = [
    "foto1.jpeg","foto2.jpeg","foto3.jpeg","foto4.jpeg",
    "foto5.jpeg","foto6.jpeg","foto7.jpeg","foto8.jpeg"
];
const fotos = fotosNombres.map(src => {
    const img = new Image();
    img.src = src;
    return img;
});

/* ================= ELEMENTOS ================= */
let elementos = [];
let TOTAL = window.innerWidth < 768 ? 30 : 80; // menos elementos en mÃ³vil
let finalizarAnimacion = false;

function crearElemento() {
    return {
        x: Math.random() * canvas.width - canvas.width/2,
        y: Math.random() * canvas.height - canvas.height/2,
        z: Math.random() * 1500 + 600,
        speed: Math.random() * 4 + 3,
        texto: mensajes[Math.floor(Math.random() * mensajes.length)],
        img: fotos[Math.floor(Math.random() * fotos.length)]
    };
}

for (let i = 0; i < TOTAL; i++) {
    elementos.push(crearElemento());
}

/* ================= ANIMACIÃ“N ================= */
let tiempo = 0;
function animar() {
    ctx.clearRect(0,0,canvas.width,canvas.height);
    ctx.save();
    ctx.translate(canvas.width/2, canvas.height/2);

    // Estrellas
    estrellas.forEach(s => {
        s.z -= s.speed;
        if (s.z <= 0) s.z = 1500;
        const k = 500 / s.z;
        const x = s.x * k;
        const y = s.y * k;
        const r = s.size * k;
        const g = ctx.createRadialGradient(x,y,0,x,y,r*4);
        g.addColorStop(0, s.color);
        g.addColorStop(1,"rgba(0,0,0,0)");
        ctx.fillStyle = g;
        ctx.beginPath();
        ctx.arc(x,y,r,0,Math.PI*2);
        ctx.fill();
    });

    // Textos y fotos
    if(!finalizarAnimacion){
        elementos.forEach((e,i) => {
            e.z -= e.speed;
            if (e.z < 50) {
                elementos[i] = crearElemento();
                return;
            }
            const k = 500 / e.z;
            if (k > 1.3) return;
            const x = e.x * k;
            const y = e.y * k;
            const img = e.img;
            const size = 70 * k * scaleFactor;
            ctx.globalAlpha = k * 1.2;
            ctx.drawImage(img, x - size/2, y - size/2, size, size);
            ctx.fillStyle = "#ff69b4";
            ctx.font = `${20*k*scaleFactor}px 'Playfair Display', serif`;
            ctx.textAlign = "center";
            ctx.fillText(e.texto, x, y - 45*k);
            ctx.globalAlpha = 1;
        });
    }

    ctx.restore();
    tiempo += 1/60;

    // Mostrar final despuÃ©s de 7s
    if(tiempo >= 7 && !document.getElementById("final").classList.contains("mostrar")) {
        finalizarAnimacion = true;
        mostrarFinal();
    }

    requestAnimationFrame(animar);
}

animar();

window.onresize = () => {
    canvas.width = innerWidth;
    canvas.height = innerHeight;
    scaleFactor = Math.min(canvas.width/1920, canvas.height/1080);
};

/* ================= FINAL ================= */
function mostrarFinal(){
    const final = document.getElementById("final");
    final.classList.add("mostrar");

    // MÃ¡s estrellas rosadas para el final
    const estrellasFinal = [];
    for(let i=0;i<300;i++){
        estrellasFinal.push({
            x: Math.random()*canvas.width - canvas.width/2,
            y: Math.random()*canvas.height - canvas.height/2,
            z: Math.random()*500+300,
            size: Math.random()*2 + 1,
            color:"#ff69b4",
            speed: Math.random()*2 + 0.5
        });
    }
    estrellas = estrellasFinal;

    function animarFinal() {
        ctx.clearRect(0,0,canvas.width,canvas.height);
        ctx.save();
        ctx.translate(canvas.width/2, canvas.height/2);
        estrellas.forEach(s => {
            s.z -= s.speed;
            if(s.z<=0) s.z = 500;
            const k = 500 / s.z;
            const x = s.x*k;
            const y = s.y*k;
            const r = s.size*k;
            const grad = ctx.createRadialGradient(x,y,0,x,y,r*4);
            grad.addColorStop(0,s.color);
            grad.addColorStop(1,"rgba(0,0,0,0)");
            ctx.fillStyle = grad;
            ctx.beginPath();
            ctx.arc(x,y,r,0,Math.PI*2);
            ctx.fill();
        });
        ctx.restore();
        requestAnimationFrame(animarFinal);
    }
    animarFinal();
}
</script>
</body>
</html>
